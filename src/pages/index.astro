---
import Layout from "../layouts/Layout.astro";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Textarea } from "@/components/ui/textarea";
import { Label } from "@/components/ui/label";
---

<Layout title="Simple Teleprompter">
  <main class="container mx-auto p-4 flex flex-col min-h-screen">
    <h1 class="text-3xl font-bold mb-8">Simple Teleprompter</h1>

    <form id="promptForm" class="flex flex-col gap-y-2 flex-1">
      <div class="mb-4 flex gap-x-4">
        <div class="flex-1">
          <Label htmlFor="title" class="block">Title</Label>
          <Input
            type="text"
            id="title"
            placeholder="Enter your script title"
            class="w-full"
            required
          />
        </div>
        <div class="w-48">
          <Label htmlFor="date" class="block">Date</Label>
          <Input
            type="text"
            id="date"
            class="w-full text-muted-foreground bg-muted cursor-default"
            disabled
          />
        </div>
      </div>

      <div class="flex flex-col flex-1 gap-y-2 min-h-0">
        <Label htmlFor="script" class="block">Script</Label>
        <Textarea
          id="script"
          placeholder="Enter your script here..."
          rows={20}
          class="w-full resize-none"
          required
        />
      </div>

      <div class="flex justify-end w-full mt-4">
        <Button type="submit" class="w-1/4">Preview Script</Button>
      </div>
    </form>
  </main>
</Layout>

<script>
  // Format and set today's date in a more readable format
  const dateInput = document.getElementById("date") as HTMLInputElement;
  const today = new Date();
  const options: Intl.DateTimeFormatOptions = {
    year: "numeric",
    month: "long",
    day: "numeric",
  };
  const formattedDate = today.toLocaleDateString("en-US", options);
  dateInput.value = formattedDate;

  document.getElementById("promptForm")?.addEventListener("submit", (e) => {
    e.preventDefault();

    const titleInput = document.getElementById("title") as HTMLInputElement;
    const scriptInput = document.getElementById(
      "script"
    ) as HTMLTextAreaElement;
    const dateInput = document.getElementById("date") as HTMLInputElement;

    const title = titleInput.value.trim();
    const script = scriptInput.value.trim();
    const date = dateInput.value;

    if (!title || !script) {
      alert(
        "Please fill in both the title and script fields before submitting."
      );
      return;
    }

    alert(`Date: ${date}\nTitle: ${title}\n\nScript:\n${script}`);
  });
</script>
